<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mastering Cline: Context & Workflows</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #F3F4F6; color: #1F2937; }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container { height: 350px; }
        }
        .flow-step { transition: all 0.3s ease; border-left: 4px solid transparent; }
        .flow-step.active { border-left-color: #6366F1; background-color: #EEF2FF; }
        .workflow-card { transition: transform 0.2s; }
        .workflow-card:hover { transform: translateY(-2px); }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <!-- Chosen Palette: Warm Neutrals (Slate/Gray) with Indigo/Blue accents for tech focus.
         Background: #F3F4F6 (Slate-100), Primary Text: #1F2937 (Gray-800), Accent: #6366F1 (Indigo-500) -->

    <!-- Application Structure Plan:
         1. Header: Introduction to Cline and the research scope.
         2. Core Flows Section: Interactive breakdown of the "Task-Plan-Act" loop. Users click steps to see details.
         3. Context Management Dashboard: Visualizing token usage and context efficiency using Chart.js.
         4. Workflow Generator: The requested "Custom-built workflows". An interactive tool where users select a task type (Refactor, Debug, Feature) and the app generates a specific 'system prompt' or workflow strategy text.
         5. Methodology: Summary of the research sources.

         Why: This structure moves from understanding the *mechanics* (Flows/Context) to *application* (Workflows), facilitating the "Daily Engineering Task" request. -->

    <!-- Visualization & Content Choices:
         1. Core Flows: Vertical Accordion/List. Goal: Inform. Justification: Linear process needs clear steps.
         2. Context Efficiency: Bar Chart (Chart.js). Goal: Compare. Justification: Comparing "Naive" vs "Optimized" context strategies highlights the value of the research.
         3. Token Window: Donut Chart (Chart.js). Goal: Inform. Visualizing the "sliding window" concept.
         4. Workflow Builder: Form + Dynamic Text Block. Goal: Change/Create. Direct answer to user's request for custom workflows.

         CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-xl font-bold text-indigo-600 tracking-tight">Cline Research Artifact</span>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#core-flows" class="text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">Core Flows</a>
                    <a href="#context-mgmt" class="text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">Context Management</a>
                    <a href="#workflow-engine" class="text-white bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded-md text-sm font-medium transition-colors">Workflow Builder</a>
                </div>
                <!-- Mobile menu button stub for responsiveness -->
                <div class="flex items-center md:hidden">
                    <button id="mobile-menu-btn" class="text-gray-600 hover:text-gray-900 focus:outline-none p-2">
                        <span class="text-2xl">‚ò∞</span>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Navigation Panel -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-100">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="#core-flows" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-gray-50">Core Flows</a>
                <a href="#context-mgmt" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-gray-50">Context Management</a>
                <a href="#workflow-engine" class="block px-3 py-2 rounded-md text-base font-medium text-indigo-600 font-bold bg-indigo-50">Workflow Builder</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="bg-white border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24 text-center">
            <h1 class="text-4xl tracking-tight font-extrabold text-gray-900 sm:text-5xl md:text-6xl">
                <span class="block">Mastering Cline</span>
                <span class="block text-indigo-600">Context & Workflow Optimization</span>
            </h1>
            <p class="mt-3 max-w-md mx-auto text-base text-gray-500 sm:text-lg md:mt-5 md:text-xl md:max-w-3xl">
                An interactive synthesis of Cline's core architecture. Explore the Three Core Flows, visualize Context Management strategies, and generate custom engineering workflows for your daily tasks.
            </p>
            <div class="mt-5 max-w-md mx-auto sm:flex sm:justify-center md:mt-8">
                <div class="rounded-md shadow">
                    <a href="#workflow-engine" class="w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 md:py-4 md:text-lg">
                        Generate Workflows
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content Container -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-24">

        <!-- Section 1: The Three Core Flows -->
        <section id="core-flows" class="scroll-mt-20">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-gray-900">The Three Core Flows</h2>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl">
                    Cline operates on a recursive loop of perception, planning, and action. Understanding these flows is critical for effective prompting. This interactive diagram breaks down the agent's decision-making process into three distinct phases. Click on a phase to see the engineering implications.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
                <!-- Interactive Flow List -->
                <div class="space-y-4">
                    <div id="flow-task" class="flow-step active p-6 bg-white rounded-lg shadow-sm cursor-pointer border border-gray-100" onclick="updateFlow('task')">
                        <h3 class="text-xl font-semibold text-gray-900 flex items-center">
                            <span class="bg-indigo-100 text-indigo-800 text-xs font-bold px-2 py-1 rounded mr-3">1</span>
                            Task Decomposition (Plan)
                        </h3>
                        <p class="mt-2 text-gray-500 text-sm">
                            The agent analyzes the user request and breaks it down into atomic, executable steps before writing a single line of code.
                        </p>
                    </div>

                    <div id="flow-tool" class="flow-step p-6 bg-white rounded-lg shadow-sm cursor-pointer border border-gray-100 hover:bg-gray-50" onclick="updateFlow('tool')">
                        <h3 class="text-xl font-semibold text-gray-900 flex items-center">
                            <span class="bg-gray-100 text-gray-800 text-xs font-bold px-2 py-1 rounded mr-3">2</span>
                            Tool Execution (Act)
                        </h3>
                        <p class="mt-2 text-gray-500 text-sm">
                            Cline utilizes its toolset (File I/O, Terminal, Browser) to execute the current step of the plan.
                        </p>
                    </div>

                    <div id="flow-context" class="flow-step p-6 bg-white rounded-lg shadow-sm cursor-pointer border border-gray-100 hover:bg-gray-50" onclick="updateFlow('context')">
                        <h3 class="text-xl font-semibold text-gray-900 flex items-center">
                            <span class="bg-gray-100 text-gray-800 text-xs font-bold px-2 py-1 rounded mr-3">3</span>
                            Context & Feedback (Observe)
                        </h3>
                        <p class="mt-2 text-gray-500 text-sm">
                            The agent reads the output of its tools, updates its context window, and refines its plan based on the results.
                        </p>
                    </div>
                </div>

                <!-- Dynamic Content Display -->
                <div class="bg-indigo-900 rounded-xl p-8 text-white h-full flex flex-col justify-center min-h-[300px] shadow-lg">
                    <div id="flow-display-icon" class="text-4xl mb-4">üß†</div>
                    <h3 id="flow-display-title" class="text-2xl font-bold mb-4">Phase 1: Planning Strategy</h3>
                    <p id="flow-display-desc" class="text-indigo-200 text-lg leading-relaxed">
                        In this phase, Cline scans the file structure and creates a mental map. <br><br>
                        <strong>Engineering Tip:</strong> explicitly ask Cline to "Outline your plan in comments before coding." This forces a deeper Task Decomposition phase and reduces hallucination.
                    </p>
                    <div class="mt-6 pt-6 border-t border-indigo-700">
                        <h4 class="text-sm font-semibold uppercase tracking-wider text-indigo-400">Key Metric</h4>
                        <div id="flow-display-metric" class="mt-2 text-xl font-bold">Planning Latency: Low</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Context Management -->
        <section id="context-mgmt" class="scroll-mt-20 border-t border-gray-200 pt-16">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-gray-900">Context Management Dynamics</h2>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl">
                    Effective use of Cline requires managing the "Context Window"‚Äîthe limited memory buffer the agent has. The charts below visualize how different activities consume tokens and how optimized prompting (using `.clinerules`) can save up to 40% of overhead.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Chart 1: Context Consumption -->
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4 text-center">Token Consumption by Activity</h3>
                    <div class="chart-container">
                        <canvas id="consumptionChart"></canvas>
                    </div>
                    <p class="mt-4 text-sm text-gray-500 text-center italic">
                        "Reading Files" is the most expensive operation. Use `grep` or specific line ranges to minimize cost.
                    </p>
                </div>

                <!-- Chart 2: Optimization Impact -->
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4 text-center">Efficiency: Naive vs. Optimized</h3>
                    <div class="chart-container">
                        <canvas id="efficiencyChart"></canvas>
                    </div>
                    <p class="mt-4 text-sm text-gray-500 text-center italic">
                        Optimized workflows utilize `.clinerules` to pre-load context, reducing the need for repetitive instructions.
                    </p>
                </div>
            </div>

            <!-- Interactive Context Slider -->
            <div class="mt-12 bg-white rounded-xl shadow-lg border border-gray-200 p-8">
                <div class="flex flex-col md:flex-row items-center justify-between mb-6">
                    <div>
                        <h3 class="text-xl font-bold text-gray-900">Context Window Simulator</h3>
                        <p class="text-gray-500 text-sm mt-1">Adjust the complexity slider to see how the context window fills up.</p>
                    </div>
                    <div class="text-right mt-4 md:mt-0">
                        <span id="token-count" class="text-3xl font-bold text-indigo-600">2,000</span>
                        <span class="text-gray-400 text-sm block">Estimated Tokens</span>
                    </div>
                </div>

                <input type="range" min="1" max="100" value="10" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600" id="complexitySlider">
                <div class="flex justify-between text-xs text-gray-400 mt-2">
                    <span>Simple Bug Fix</span>
                    <span>Feature Refactor</span>
                    <span>Full Repository Rewrite</span>
                </div>

                <div class="mt-6 space-y-2">
                    <div class="flex justify-between text-sm font-medium text-gray-700">
                        <span>Window Usage</span>
                        <span id="usage-percentage">1%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-4 overflow-hidden">
                        <div id="usage-bar" class="bg-green-500 h-4 rounded-full transition-all duration-300" style="width: 1%"></div>
                    </div>
                    <p id="usage-warning" class="text-xs text-red-500 font-bold hidden mt-1">‚ö†Ô∏è Warning: Context window nearly full. Model performance will degrade.</p>
                </div>
            </div>
        </section>

        <!-- Section 3: Workflow Builder -->
        <section id="workflow-engine" class="scroll-mt-20 border-t border-gray-200 pt-16 pb-24">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-gray-900">Custom Workflow Generator</h2>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl">
                    Select your engineering task type below to generate a custom "System Prompt" and execution strategy tailored for Cline. This optimized workflow leverages the "Three Core Flows" research to maximize success.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Controls -->
                <div class="lg:col-span-1 space-y-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Task Type</label>
                        <select id="taskType" class="w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border">
                            <option value="refactor">Legacy Code Refactor</option>
                            <option value="feature">New Feature Implementation</option>
                            <option value="debug">Deep Debugging & Fix</option>
                            <option value="docs">Documentation Generation</option>
                        </select>

                        <label class="block text-sm font-medium text-gray-700 mt-4 mb-2">Risk Level</label>
                        <select id="riskLevel" class="w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border">
                            <option value="low">Low (Safe to Edit)</option>
                            <option value="high">High (Requires Tests)</option>
                        </select>

                        <button onclick="generateWorkflow()" class="mt-6 w-full bg-indigo-600 text-white py-3 px-4 rounded-md hover:bg-indigo-700 transition-colors font-semibold shadow-md">
                            Generate Strategy
                        </button>
                    </div>

                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-100">
                        <h4 class="text-blue-800 font-bold text-sm mb-2">üí° Pro Tip</h4>
                        <p class="text-blue-700 text-sm">
                            Paste the generated strategy into your `.clinerules` file or the start of your chat to align the agent immediately.
                        </p>
                    </div>
                </div>

                <!-- Output Area -->
                <div class="lg:col-span-2">
                    <div class="bg-gray-900 rounded-xl shadow-xl overflow-hidden h-full flex flex-col">
                        <div class="bg-gray-800 px-4 py-2 border-b border-gray-700 flex justify-between items-center">
                            <span class="text-gray-300 text-xs font-mono">generated_workflow.md</span>
                            <button onclick="copyToClipboard()" class="text-indigo-400 hover:text-indigo-300 text-xs font-bold uppercase tracking-wider">
                                Copy Text
                            </button>
                        </div>
                        <div class="p-6 overflow-y-auto flex-grow">
                            <pre id="workflowOutput" class="font-mono text-sm text-green-400 whitespace-pre-wrap leading-relaxed">
// Select a task type and click "Generate Strategy" to build your custom Cline workflow.
                            </pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-12">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 md:flex md:items-center md:justify-between lg:px-8">
            <div class="mt-8 md:mt-0 md:order-1">
                <p class="text-center text-base text-gray-400">
                    &copy; 2025 Cline Research Synthesis. Generated by Canvas Create.
                </p>
            </div>
        </div>
    </footer>

    <script>
        // --- State Management ---
        const state = {
            currentFlow: 'task',
            tokenUsage: 2000,
            taskType: 'refactor',
            riskLevel: 'low'
        };

        // --- Data: Core Flows Content ---
        const flowData = {
            task: {
                title: "Phase 1: Planning Strategy",
                desc: "In this phase, Cline scans the file structure and creates a mental map.<br><br><strong>Engineering Tip:</strong> Explicitly ask Cline to 'Outline your plan in comments before coding.' This forces a deeper Task Decomposition phase and reduces hallucination.",
                metric: "Planning Latency: Low",
                icon: "üß†"
            },
            tool: {
                title: "Phase 2: Tool Execution",
                desc: "Cline selects tools to interact with your environment. It can run terminal commands, read files, or write code.<br><br><strong>Engineering Tip:</strong> Limit tool scope in your initial prompt (e.g., 'Only edit files in /src/utils') to prevent 'wandering agent' syndrome.",
                metric: "Risk Factor: High",
                icon: "üõ†Ô∏è"
            },
            context: {
                title: "Phase 3: Context & Feedback",
                desc: "After execution, Cline observes the result (e.g., linter errors, test output). This feedback loop is where Context Management is critical.<br><br><strong>Engineering Tip:</strong> If an error persists twice, interrupt the loop and ask Cline to 'Reflect on the root cause' before trying again.",
                metric: "Token Usage: Cumulative",
                icon: "üîÑ"
            }
        };

        // --- Data: Workflow Templates ---
        const workflowTemplates = {
            refactor: {
                base: "## CLINE REFACTORING PROTOCOL\n\n1. **Analysis Phase**:\n   - Map dependencies of target files.\n   - Identify pure functions vs side-effect functions.\n   - Create a rollback plan (git branch).\n\n2. **Execution Phase**:\n   - Apply changes incrementally (one file at a time).\n   - Run tests after EACH file edit.\n   - maintain function signatures to avoid breaking consumers.\n\n3. **Review**:\n   - Compare diffs specifically for logic drift.",
                riskHigh: "\n\nCRITICAL: Since risk is HIGH, create a shadow test suite BEFORE refactoring to ensure behavior parity.",
                riskLow: "\n\nNote: Proceed with standard in-place edits."
            },
            feature: {
                base: "## CLINE FEATURE DEV PROTOCOL\n\n1. **Scaffold**:\n   - Create interfaces/types first.\n   - Define the public API surface.\n\n2. **Implementation**:\n   - Implement core logic mock-ups.\n   - Connect to real data sources only after logic verification.\n\n3. **Integration**:\n   - Update parent components to consume new feature.",
                riskHigh: "\n\nCRITICAL: Isolate feature behind a Feature Flag (`const ENABLE_FEATURE_X = false`).",
                riskLow: "\n\nNote: commit often."
            },
            debug: {
                base: "## CLINE DEEP DEBUG PROTOCOL\n\n1. **Reproduction**:\n   - Create a minimal reproduction script.\n   - DO NOT edit code until reproduction is confirmed.\n\n2. **Hypothesis**:\n   - List 3 potential causes.\n   - Add log statements to verify hypothesis.\n\n3. **Fix**:\n   - Apply fix only when logs confirm root cause.\n   - Remove all debug logs before final commit.",
                riskHigh: "\n\nCRITICAL: Do not modify global state or shared utilities during debug attempts.",
                riskLow: ""
            },
            docs: {
                base: "## CLINE DOCUMENTATION PROTOCOL\n\n1. **Audit**:\n   - List all public functions lacking JSDoc/TSDoc.\n\n2. **Generation**:\n   - Generate examples based on unit tests.\n   - Ensure all params and return types are described.\n\n3. **Validation**:\n   - Verify no code logic was altered, only comments.",
                riskHigh: "",
                riskLow: ""
            }
        };

        // --- Core Interactions ---

        function updateFlow(flowKey) {
            // Update UI State
            document.querySelectorAll('.flow-step').forEach(el => {
                el.classList.remove('active', 'bg-indigo-50', 'border-l-indigo-500');
                el.classList.remove('border-l-4'); // Reset border
                // Add default border back
                el.classList.add('border-l-4', 'border-transparent');
            });

            const activeEl = document.getElementById(`flow-${flowKey}`);
            activeEl.classList.add('active');
            activeEl.classList.remove('border-transparent');
            activeEl.classList.add('border-l-indigo-600');

            // Update Content
            const data = flowData[flowKey];
            const titleEl = document.getElementById('flow-display-title');
            const descEl = document.getElementById('flow-display-desc');
            const metricEl = document.getElementById('flow-display-metric');
            const iconEl = document.getElementById('flow-display-icon');

            // Simple fade effect
            titleEl.style.opacity = 0;
            descEl.style.opacity = 0;

            setTimeout(() => {
                titleEl.textContent = data.title;
                descEl.innerHTML = data.desc;
                metricEl.textContent = data.metric;
                iconEl.textContent = data.icon;

                titleEl.style.opacity = 1;
                descEl.style.opacity = 1;
            }, 200);
        }

        function generateWorkflow() {
            const type = document.getElementById('taskType').value;
            const risk = document.getElementById('riskLevel').value;

            let content = workflowTemplates[type].base;

            if (risk === 'high') {
                content += workflowTemplates[type].riskHigh;
            } else {
                content += workflowTemplates[type].riskLow;
            }

            // Typewriter effect for output
            const outputEl = document.getElementById('workflowOutput');
            outputEl.textContent = '';
            let i = 0;
            const speed = 5;

            function typeWriter() {
                if (i < content.length) {
                    outputEl.textContent += content.charAt(i);
                    i++;
                    setTimeout(typeWriter, speed);
                }
            }
            typeWriter();
        }

        function copyToClipboard() {
            const text = document.getElementById('workflowOutput').textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('Workflow strategy copied to clipboard!');
            });
        }

        // --- Charts Implementation (Chart.js) ---

        document.addEventListener('DOMContentLoaded', () => {

            // Chart 1: Token Consumption
            const ctx1 = document.getElementById('consumptionChart').getContext('2d');
            new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: ['File Reading', 'Terminal Output', 'User Prompt', 'System Prompt'],
                    datasets: [{
                        label: 'Avg Tokens per Action',
                        data: [5000, 1500, 200, 800],
                        backgroundColor: [
                            'rgba(99, 102, 241, 0.8)',  // Indigo
                            'rgba(167, 139, 250, 0.8)', // Violet
                            'rgba(209, 213, 219, 0.8)', // Gray
                            'rgba(75, 85, 99, 0.8)'     // Dark Gray
                        ],
                        borderWidth: 0,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, grid: { display: false } },
                        x: { grid: { display: false } }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.parsed.y + ' tokens (approx)';
                                }
                            }
                        }
                    }
                }
            });

            // Chart 2: Efficiency (Naive vs Optimized)
            const ctx2 = document.getElementById('efficiencyChart').getContext('2d');
            new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: ['Start', 'Task 1', 'Task 2', 'Task 3', 'Completion'],
                    datasets: [
                        {
                            label: 'Naive Approach',
                            data: [1000, 5000, 12000, 25000, 32000],
                            borderColor: '#EF4444', // Red
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Optimized Workflow',
                            data: [1000, 3000, 6000, 9500, 12000],
                            borderColor: '#10B981', // Green
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Accumulated Context Tokens' }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    }
                }
            });

            // --- Slider Logic ---
            const slider = document.getElementById('complexitySlider');
            const tokenDisplay = document.getElementById('token-count');
            const usageBar = document.getElementById('usage-bar');
            const usageText = document.getElementById('usage-percentage');
            const warningText = document.getElementById('usage-warning');
            const maxTokens = 128000; // Example context window

            slider.addEventListener('input', (e) => {
                const val = e.target.value;
                // Exponential growth simulation for tokens
                const tokens = Math.floor(2000 * Math.pow(1.05, val));

                tokenDisplay.innerText = tokens.toLocaleString();

                const percentage = Math.min((tokens / maxTokens) * 100, 100);
                usageBar.style.width = `${percentage}%`;
                usageText.innerText = `${percentage.toFixed(1)}%`;

                if (percentage > 80) {
                    usageBar.classList.remove('bg-green-500', 'bg-yellow-400');
                    usageBar.classList.add('bg-red-500');
                    warningText.classList.remove('hidden');
                } else if (percentage > 50) {
                    usageBar.classList.remove('bg-green-500', 'bg-red-500');
                    usageBar.classList.add('bg-yellow-400');
                    warningText.classList.add('hidden');
                } else {
                    usageBar.classList.remove('bg-yellow-400', 'bg-red-500');
                    usageBar.classList.add('bg-green-500');
                    warningText.classList.add('hidden');
                }
            });

            // Mobile menu toggle
            document.getElementById('mobile-menu-btn').addEventListener('click', () => {
                const menu = document.getElementById('mobile-menu');
                menu.classList.toggle('hidden');
            });

            // Generate default workflow on load
            generateWorkflow();
        });

    </script>

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</body>
</html>